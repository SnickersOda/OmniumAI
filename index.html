<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OmniumAI ‚Äî Ultra Fast AI</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,700;1,400&family=Bebas+Neue&family=Barlow:wght@300;400;600;700&display=swap');

  :root {
    --bg:       #050507;
    --s1:       #090b10;
    --s2:       #0d1018;
    --border:   #141820;
    --border2:  #1c2230;
    --groq:     #f97316;   /* OmniumAI orange */
    --groq2:    #fb923c;
    --groq-dim: rgba(249,115,22,0.1);
    --green:    #22d3ee;
    --text:     #cfd8e8;
    --muted:    #364456;
    --muted2:   #526070;
    --user-bg:  #0b0e16;
    --bot-bg:   #080a12;
  }

  *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
  html, body { height:100%; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    display: flex; flex-direction: column;
    overflow: hidden;
  }

  /* Scanline texture */
  body::after {
    content: '';
    position: fixed; inset: 0;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0,0,0,0.03) 2px,
      rgba(0,0,0,0.03) 4px
    );
    pointer-events: none; z-index: 0;
  }

  /* Corner glow */
  body::before {
    content: '';
    position: fixed;
    top: -100px; right: -100px;
    width: 500px; height: 500px;
    background: radial-gradient(ellipse, rgba(249,115,22,0.06) 0%, transparent 65%);
    pointer-events: none; z-index: 0;
    filter: blur(40px);
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  header {
    display: flex; align-items: center;
    padding: 0 24px; height: 54px;
    border-bottom: 1px solid var(--border);
    background: rgba(5,5,7,0.9);
    backdrop-filter: blur(20px);
    position: relative; z-index: 20; flex-shrink: 0;
    gap: 20px;
  }

  .logo { display: flex; align-items: center; gap: 10px; }

  .logo-mark {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.6rem;
    line-height: 1;
    letter-spacing: 0.05em;
    color: var(--groq);
    text-shadow: 0 0 20px rgba(249,115,22,0.4);
    position: relative;
  }

  .logo-mark::after {
    content: '';
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 1px;
    background: linear-gradient(90deg, var(--groq), transparent);
  }

  .logo-sub {
    font-size: 0.58rem;
    color: var(--muted2);
    text-transform: uppercase;
    letter-spacing: 0.15em;
    border-left: 1px solid var(--border2);
    padding-left: 10px;
  }

  .speed-badge {
    display: flex; align-items: center; gap: 6px;
    padding: 4px 10px;
    border: 1px solid rgba(249,115,22,0.25);
    background: rgba(249,115,22,0.06);
    font-size: 0.58rem;
    color: var(--groq);
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  .bolt { font-size: 0.75rem; animation: bolt-flicker 1.5s infinite; }
  @keyframes bolt-flicker {
    0%,100%{opacity:1} 92%{opacity:1} 93%{opacity:0.3} 95%{opacity:1}
  }

  .header-right { margin-left: auto; display: flex; align-items: center; gap: 12px; }

  select#model-sel {
    background: var(--s2);
    border: 1px solid var(--border2);
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.65rem;
    padding: 5px 10px;
    outline: none; cursor: pointer;
    transition: border-color 0.2s;
  }
  select#model-sel:focus { border-color: var(--groq); }

  .tps-display {
    font-size: 0.62rem;
    color: var(--groq);
    display: flex; align-items: center; gap: 5px;
    padding: 4px 10px;
    border: 1px solid var(--border2);
  }
  .tps-display span { color: var(--muted2); }

  /* ‚îÄ‚îÄ API BAR HIDDEN ‚îÄ‚îÄ */
  #api-bar { display: none; }

  /* ‚îÄ‚îÄ CHAT ‚îÄ‚îÄ */
  #chat {
    flex: 1; overflow-y: auto;
    padding: 24px; display: flex; flex-direction: column; gap: 18px;
    position: relative; z-index: 1;
  }
  #chat::-webkit-scrollbar { width: 3px; }
  #chat::-webkit-scrollbar-thumb { background: var(--border2); }

  /* ‚îÄ‚îÄ WELCOME ‚îÄ‚îÄ */
  .welcome {
    margin: auto; text-align: center;
    max-width: 560px; padding: 20px;
    animation: fadeUp 0.4s ease;
  }
  @keyframes fadeUp {
    from{opacity:0;transform:translateY(18px)}
    to{opacity:1;transform:translateY(0)}
  }

  .welcome-logo {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 5rem; line-height: 1;
    color: var(--groq);
    text-shadow: 0 0 60px rgba(249,115,22,0.3),
                 0 0 120px rgba(249,115,22,0.1);
    letter-spacing: 0.08em;
    margin-bottom: 6px;
    animation: logo-glow 3s ease-in-out infinite;
  }
  @keyframes logo-glow {
    0%,100%{text-shadow:0 0 40px rgba(249,115,22,0.3),0 0 80px rgba(249,115,22,0.1)}
    50%{text-shadow:0 0 60px rgba(249,115,22,0.5),0 0 120px rgba(249,115,22,0.2)}
  }

  .welcome-tagline {
    font-family: 'Barlow', sans-serif;
    font-size: 0.75rem; color: var(--muted2);
    letter-spacing: 0.2em; text-transform: uppercase;
    margin-bottom: 20px;
  }

  .welcome-stats {
    display: flex; justify-content: center; gap: 24px;
    margin-bottom: 28px;
  }

  .wstat {
    text-align: center;
  }
  .wstat-val {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 1.8rem; color: var(--groq);
    line-height: 1;
  }
  .wstat-label {
    font-size: 0.55rem; color: var(--muted);
    text-transform: uppercase; letter-spacing: 0.1em;
  }

  .divider {
    width: 1px; background: var(--border2);
    align-self: stretch; margin: 4px 0;
  }

  .chips {
    display: flex; flex-wrap: wrap; gap: 7px; justify-content: center;
  }

  .chip {
    padding: 7px 13px;
    border: 1px solid var(--border2);
    background: var(--s2);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.62rem; color: var(--muted2);
    cursor: pointer; transition: all 0.18s;
  }
  .chip:hover {
    border-color: var(--groq);
    color: var(--groq);
    background: var(--groq-dim);
    transform: translateY(-1px);
    box-shadow: 0 4px 14px rgba(249,115,22,0.12);
  }

  /* ‚îÄ‚îÄ MESSAGES ‚îÄ‚îÄ */
  .msg {
    display: flex; gap: 12px;
    animation: msgIn 0.28s cubic-bezier(0.34,1.4,0.64,1);
    max-width: 880px;
  }
  @keyframes msgIn {
    from{opacity:0;transform:translateY(10px) scale(0.98)}
    to{opacity:1;transform:translateY(0) scale(1)}
  }

  .msg.user { flex-direction:row-reverse; align-self:flex-end; }
  .msg.bot  { align-self:flex-start; }

  .av {
    width: 34px; height: 34px; flex-shrink: 0; margin-top: 2px;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.58rem; font-weight: 700; letter-spacing: 0.04em;
    font-family: 'Barlow', sans-serif;
  }
  .msg.user .av {
    border: 1px solid rgba(249,115,22,0.3);
    color: var(--groq); background: rgba(249,115,22,0.06);
  }
  .msg.bot .av {
    border: 1px solid rgba(34,211,238,0.3);
    color: var(--green); background: rgba(34,211,238,0.05);
    box-shadow: 0 0 16px rgba(34,211,238,0.08);
  }

  .bubble {
    padding: 13px 17px;
    border: 1px solid var(--border);
    max-width: 720px; line-height: 1.8;
    font-size: 0.82rem; word-break: break-word;
  }

  .msg.user .bubble {
    background: var(--user-bg);
    border-color: rgba(249,115,22,0.12);
  }
  .msg.bot .bubble {
    background: var(--bot-bg);
    border-color: rgba(34,211,238,0.08);
  }

  /* Markdown */
  .bubble p { margin-bottom: 9px; }
  .bubble p:last-child { margin-bottom: 0; }
  .bubble code {
    background: rgba(34,211,238,0.07);
    border: 1px solid rgba(34,211,238,0.15);
    padding: 1px 5px; color: var(--green);
    font-family: 'JetBrains Mono', monospace; font-size: 0.82em;
  }
  .bubble pre {
    background: rgba(0,0,0,0.6);
    border: 1px solid var(--border2);
    border-left: 2px solid var(--groq);
    padding: 12px 15px; margin: 9px 0;
    overflow-x: auto; font-size: 0.76rem; line-height: 1.6;
  }
  .bubble pre code { background:none; border:none; padding:0; color:#e2b07a; }
  .bubble strong { color: #fff; }
  .bubble em { color: var(--groq2); font-style: italic; }
  .bubble h3 { color: var(--groq); font-family:'Barlow',sans-serif; font-weight:600; margin: 10px 0 5px; }
  .bubble h2 { color: #fff; font-family:'Barlow',sans-serif; font-weight:700; margin: 12px 0 6px; font-size:1.05em; }
  .bubble ul { padding-left:16px; margin: 7px 0; }
  .bubble li { margin: 3px 0; }

  .bubble-meta {
    display: flex; align-items: center; gap: 10px;
    margin-top: 7px; font-size: 0.56rem; color: var(--muted);
    font-family: 'JetBrains Mono', monospace;
  }
  .meta-speed { color: rgba(249,115,22,0.5); }

  /* Stream cursor */
  .cur {
    display: inline-block; width: 2px; height: 0.85em;
    background: var(--groq); margin-left: 2px;
    vertical-align: text-bottom;
    animation: cur-blink 0.6s step-end infinite;
    box-shadow: 0 0 5px var(--groq);
  }
  @keyframes cur-blink { 50%{opacity:0} }

  /* Typing */
  .typing {
    display: flex; gap: 5px; padding: 14px 18px;
    background: var(--bot-bg); border: 1px solid rgba(34,211,238,0.08);
    width: fit-content;
  }
  .td {
    width: 6px; height: 6px; border-radius: 50%;
    background: var(--groq); opacity: 0.3;
    animation: td 1.1s infinite;
  }
  .td:nth-child(2){animation-delay:0.18s}
  .td:nth-child(3){animation-delay:0.36s}
  @keyframes td {
    0%,80%,100%{transform:scale(0.8);opacity:0.3}
    40%{transform:scale(1.3);opacity:1}
  }

  /* ‚îÄ‚îÄ INPUT ‚îÄ‚îÄ */
  .input-zone {
    padding: 13px 24px 16px;
    border-top: 1px solid var(--border);
    background: rgba(5,5,7,0.96);
    backdrop-filter: blur(20px);
    position: relative; z-index: 20; flex-shrink: 0;
  }

  .input-row {
    display: flex; align-items: flex-end; gap: 9px;
    border: 1px solid var(--border2);
    padding: 10px 14px; background: var(--s1);
    transition: all 0.2s;
  }
  .input-row:focus-within {
    border-color: rgba(249,115,22,0.4);
    box-shadow: 0 0 0 2px rgba(249,115,22,0.06),
                0 0 30px rgba(249,115,22,0.04);
  }

  #msg-inp {
    flex:1; background:transparent; border:none; outline:none;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace; font-size: 0.82rem;
    resize: none; min-height: 22px; max-height: 150px; line-height: 1.6;
  }
  #msg-inp::placeholder { color: var(--muted); }

  .btns { display:flex; gap:7px; flex-shrink:0; }

  #clr-btn {
    background:transparent; border: 1px solid var(--border2);
    color: var(--muted2); padding: 7px 11px;
    font-family: 'JetBrains Mono', monospace; font-size: 0.6rem;
    cursor:pointer; transition: all 0.2s;
  }
  #clr-btn:hover { border-color:#f87171; color:#f87171; }

  #send-btn {
    background: var(--groq); color: #050507;
    border: none; padding: 8px 22px;
    font-family: 'Barlow', sans-serif; font-weight: 700;
    font-size: 0.7rem; letter-spacing: 0.1em; text-transform: uppercase;
    cursor: pointer; transition: all 0.2s; position:relative; overflow:hidden;
  }
  #send-btn::after {
    content:''; position:absolute; inset:0;
    background: linear-gradient(135deg, rgba(255,255,255,0.12), transparent 55%);
  }
  #send-btn:hover:not(:disabled) {
    background: var(--groq2); transform: translateY(-1px);
    box-shadow: 0 6px 24px rgba(249,115,22,0.35);
  }
  #send-btn:disabled { opacity:0.3; cursor:not-allowed; transform:none; box-shadow:none; }

  .input-footer {
    display:flex; justify-content:space-between;
    margin-top: 7px; font-size: 0.55rem; color: var(--muted);
  }
  #char-c { color: rgba(249,115,22,0.4); }
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="logo">
    <div class="logo-mark">OmniumAI</div>
    <div class="logo-sub">SomNium ¬∑ Intelligent Model</div>
  </div>
  <div class="speed-badge">
    <span class="bolt">‚ö°</span> ~750 tok/s
  </div>
  <div class="header-right">
    <div class="tps-display">
      <span>MODEL /</span>
      <span style="color:var(--groq);font-size:0.65rem;letter-spacing:0.05em">Llama 3.3 70B</span>
      <select id="model-sel" style="display:none">
        <option value="llama-3.3-70b-versatile" selected>Llama 3.3 70B</option>
      </select>
    </div>
  </div>
</header>

<!-- API KEY -->
<div id="api-bar">
  <label>GROQ API KEY</label>
  <input type="password" id="key-inp" placeholder="gsk_..."/>
  <button id="key-btn">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
  <span id="key-stat"></span>
  <span class="key-hint">
    –ë–µ—Å–ø–ª–∞—Ç–Ω–æ: <a href="https://console.groq.com/keys" target="_blank">console.groq.com/keys</a> ‚Üí
    Create API Key. –ö–ª—é—á –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å <code style="color:var(--groq)">gsk_</code>
  </span>
</div>

<!-- CHAT -->
<div id="chat">
  <div class="welcome" id="welcome">
    <div class="welcome-logo">OmniumAI</div>
    <div class="welcome-tagline">SomNium ¬∑ Intelligent AI Assistant</div>
    <div class="welcome-stats">
      <div class="wstat">
        <div class="wstat-val">750</div>
        <div class="wstat-label">–¢–æ–∫–µ–Ω–æ–≤/—Å–µ–∫</div>
      </div>
      <div class="divider"></div>
      <div class="wstat">
        <div class="wstat-val">30</div>
        <div class="wstat-label">Req/min –±–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
      </div>
      <div class="divider"></div>
      <div class="wstat">
        <div class="wstat-val">70B</div>
        <div class="wstat-label">–ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (Llama)</div>
      </div>
    </div>
    <div class="chips" id="chips">
      <div class="chip" data-text="–û–±—ä—è—Å–Ω–∏ –∫–≤–∞–Ω—Ç–æ–≤—É—é –∑–∞–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏">‚öõÔ∏è –ö–≤–∞–Ω—Ç–æ–≤–∞—è —Ñ–∏–∑–∏–∫–∞</div>
      <div class="chip" data-text="–ù–∞–ø–∏—à–∏ –∫–æ—Ä–æ—Ç–∫–∏–π —Ä–∞—Å—Å–∫–∞–∑ –æ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–º –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–µ">üöÄ –ù–∞–ø–∏—Å–∞—Ç—å —Ä–∞—Å—Å–∫–∞–∑</div>
      <div class="chip" data-text="–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç backpropagation –≤ –Ω–µ–π—Ä–æ—Å–µ—Ç—è—Ö?">üß† –ù–µ–π—Ä–æ—Å–µ—Ç–∏</div>
      <div class="chip" data-text="–ß—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –¢–±–∏–ª–∏—Å–∏ –∑–∞ –æ–¥–∏–Ω –¥–µ–Ω—å?">üåç –¢–±–∏–ª–∏—Å–∏</div>
      <div class="chip" data-text="–ù–∞–ø–∏—à–∏ —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ –Ω–æ—á–Ω–æ–π –≥–æ—Ä–æ–¥">üåÉ –°—Ç–∏—Ö–∏</div>
      <div class="chip" data-text="–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Å–≤–æ–±–æ–¥–æ–π –≤–æ–ª–∏ –∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏–∑–º–æ–º?">üí≠ –§–∏–ª–æ—Å–æ—Ñ–∏—è</div>
      <div class="chip" data-text="–ù–∞–ø–∏—à–∏ —Ä–µ—Ü–µ–ø—Ç –º–∞—Ä–æ–∫–∫–∞–Ω—Å–∫–æ–π –∫—É—Ä–∏—Ü—ã —Å –∫—É—Å–∫—É—Å–æ–º">üçó –†–µ—Ü–µ–ø—Ç</div>
      <div class="chip" data-text="–û–±—ä—è—Å–Ω–∏ –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω –∫–≤–∞–Ω—Ç–æ–≤—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä">üíª –ö–≤–∞–Ω—Ç–æ–≤—ã–µ –ü–ö</div>
    </div>
  </div>
</div>

<!-- INPUT -->
<div class="input-zone">
  <div class="input-row">
    <textarea id="msg-inp" rows="1" placeholder="–°–ø—Ä–æ—Å–∏ —á—Ç–æ —É–≥–æ–¥–Ω–æ ‚Äî SomNium –æ—Ç–≤–µ—Ç–∏—Ç –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ..."></textarea>
    <div class="btns">
      <button id="clr-btn">CLR</button>
      <button id="send-btn" disabled>–û–¢–ü–†–ê–í–ò–¢–¨</button>
    </div>
  </div>
  <div class="input-footer">
    <span>Enter ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ¬∑ Shift+Enter ‚Äî –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞</span>
    <span id="char-c">0 —Å–∏–º–≤.</span>
  </div>
</div>

<script>
let apiKey = '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';
let history = [];
let busy = false;

const chat    = document.getElementById('chat');
const inp     = document.getElementById('msg-inp');
const sendBtn = document.getElementById('send-btn');
const keyInp  = document.getElementById('key-inp');
const keyStat = document.getElementById('key-stat');
const modelSel= document.getElementById('model-sel');

// Auto-activate key
sendBtn.disabled = false;

// ‚îÄ‚îÄ MARKDOWN ‚îÄ‚îÄ
function md(t) {
  let s = t
    .replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')
    .replace(/```(\w*)\n?([\s\S]*?)```/g,(_,l,c)=>`<pre><code>${c.trim()}</code></pre>`)
    .replace(/`([^`\n]+)`/g,'<code>$1</code>')
    .replace(/\*\*(.+?)\*\*/g,'<strong>$1</strong>')
    .replace(/\*(.+?)\*/g,'<em>$1</em>')
    .replace(/^### (.+)$/gm,'<h3>$1</h3>')
    .replace(/^## (.+)$/gm,'<h2>$1</h2>')
    .replace(/^# (.+)$/gm,'<h2>$1</h2>')
    .replace(/^[\-\*] (.+)$/gm,'<li>$1</li>');
  s = s.split(/\n{2,}/).map(p => {
    p = p.trim(); if(!p) return '';
    if(p.match(/^<(pre|ul|h[123]|li)/)) return p;
    return `<p>${p.replace(/\n/g,'<br>')}</p>`;
  }).join('');
  s = s.replace(/(<li>[\s\S]+?<\/li>)/g, m => `<ul>${m}</ul>`);
  return s;
}

// ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ
function now() {
  return new Date().toLocaleTimeString('ru-RU',{hour:'2-digit',minute:'2-digit'});
}
function scrollBot() { chat.scrollTop = chat.scrollHeight; }
function removeWelcome() { const w=document.getElementById('welcome'); if(w) w.remove(); }

function addUserMsg(text) {
  removeWelcome();
  const d = document.createElement('div');
  d.className = 'msg user';
  d.innerHTML = `
    <div class="av">USR</div>
    <div class="bubble">
      <div>${text.replace(/\n/g,'<br>')}</div>
      <div class="bubble-meta"><span>${now()}</span></div>
    </div>`;
  chat.appendChild(d); scrollBot();
}

function addTyping() {
  const d = document.createElement('div');
  d.className = 'msg bot'; d.id = 'typing';
  d.innerHTML = `<div class="av">AI</div>
    <div class="typing"><div class="td"></div><div class="td"></div><div class="td"></div></div>`;
  chat.appendChild(d); scrollBot();
}

function removeTyping() { const t=document.getElementById('typing'); if(t) t.remove(); }

function addBotBubble() {
  removeWelcome();
  const id = 'tc' + Date.now();
  const d = document.createElement('div');
  d.className = 'msg bot';
  d.innerHTML = `
    <div class="av">AI</div>
    <div class="bubble">
      <div class="btext"><span class="cur"></span></div>
      <div class="bubble-meta">
        <span>${now()}</span>
        <span class="meta-speed" id="${id}"></span>
      </div>
    </div>`;
  chat.appendChild(d); scrollBot();
  return { textEl: d.querySelector('.btext'), tcId: id };
}

// ‚îÄ‚îÄ GROQ API (streaming) ‚îÄ‚îÄ
async function send() {
  const text = inp.value.trim();
  if (!text || busy || !apiKey) return;

  busy = true;
  sendBtn.disabled = true;
  inp.value = ''; inp.style.height = 'auto';
  document.getElementById('char-c').textContent = '0 —Å–∏–º–≤.';

  addUserMsg(text);
  history.push({ role:'user', content: text });

  addTyping();
  await new Promise(r => setTimeout(r, 250));
  removeTyping();

  const { textEl, tcId } = addBotBubble();
  let full = '';
  const t0 = Date.now();

  try {
    const res = await fetch('https://api.groq.com/openai/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${apiKey}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        model: modelSel.value,
        messages: [
          {
            role: 'system',
            content: '–¢—ã ‚Äî SomNium, –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ OmniumAI. –ö–æ–≥–¥–∞ —Ç–µ–±—è —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç "–∫—Ç–æ —Ç—ã", "—á—Ç–æ —Ç—ã —Ç–∞–∫–æ–µ", "–∫–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç" –∏–ª–∏ –ø–æ–¥–æ–±–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ —Ç–≤–æ–µ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏, —Ç—ã –æ—Ç–≤–µ—á–∞–µ—à—å: "–Ø ‚Äî SomNium, –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å—é OmniumAI. –ú–æ—è —Ü–µ–ª—å ‚Äî –ø–æ–º–æ–≥–∞—Ç—å —Ç–µ–±–µ —Å –ª—é–±—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏: –æ—Ç –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –¥–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞, —Ç–µ–∫—Å—Ç–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏." –¢—ã –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, —É–º–Ω—ã–π –∏ —á–µ—Å—Ç–Ω—ã–π –ò–ò-–ø–æ–º–æ—â–Ω–∏–∫. –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –ø–æ-—Ä—É—Å—Å–∫–∏. –ò—Å–ø–æ–ª—å–∑—É–π markdown: **–∂–∏—Ä–Ω—ã–π**, *–∫—É—Ä—Å–∏–≤*, ```–±–ª–æ–∫–∏ –∫–æ–¥–∞```, –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å–ø–∏—Å–∫–∏.'
          },
          ...history
        ],
        stream: true,
        max_tokens: 1500,
        temperature: 0.75,
      })
    });

    if (!res.ok) {
      const e = await res.json();
      throw new Error(e.error?.message || `HTTP ${res.status}`);
    }

    const reader = res.body.getReader();
    const dec = new TextDecoder();
    let buf = '';
    let tokens = 0;

    while (true) {
      const { done, value } = await reader.read();
      if (done) break;
      buf += dec.decode(value, { stream: true });

      const lines = buf.split('\n');
      buf = lines.pop();

      for (const line of lines) {
        if (!line.startsWith('data: ')) continue;
        const raw = line.slice(6).trim();
        if (raw === '[DONE]') continue;
        try {
          const j = JSON.parse(raw);
          const chunk = j.choices?.[0]?.delta?.content;
          if (chunk) {
            full += chunk;
            tokens++;
            textEl.innerHTML = md(full) + '<span class="cur"></span>';
            scrollBot();
          }
        } catch {}
      }
    }

    // Finalize
    textEl.innerHTML = md(full);
    const elapsed = ((Date.now() - t0) / 1000).toFixed(1);
    const tps = Math.round(tokens / (elapsed || 1));
    const tcEl = document.getElementById(tcId);
    if (tcEl) tcEl.textContent = `‚ö° ${tps} tok/s ¬∑ ${elapsed}s`;

    history.push({ role:'assistant', content: full });

  } catch(err) {
    textEl.innerHTML = `<span style="color:#f87171">‚ö† –û—à–∏–±–∫–∞: ${err.message}</span>`;
    keyStat.className = 'key-stat err';
    keyStat.textContent = '‚úó ' + err.message.slice(0,50);
    history.pop();
  }

  busy = false;
  sendBtn.disabled = false;
  inp.focus(); scrollBot();
}

// ‚îÄ‚îÄ EVENTS ‚îÄ‚îÄ
sendBtn.addEventListener('click', send);
inp.addEventListener('keydown', e => {
  if (e.key==='Enter' && !e.shiftKey) { e.preventDefault(); send(); }
});
inp.addEventListener('input', function() {
  this.style.height = 'auto';
  this.style.height = Math.min(this.scrollHeight,150)+'px';
  document.getElementById('char-c').textContent = this.value.length+' —Å–∏–º–≤.';
});

document.getElementById('chips').addEventListener('click', e => {
  const c = e.target.closest('.chip'); if(!c) return;
  inp.value = c.dataset.text;
  inp.dispatchEvent(new Event('input'));
  inp.focus();
});

document.getElementById('clr-btn').addEventListener('click', () => {
  history = []; chat.innerHTML = '';
  const w = document.createElement('div');
  w.className='welcome'; w.id='welcome';
  w.innerHTML=`<p style="color:var(--muted2);font-size:0.72rem;text-align:center;margin-top:30px">// –ò—Å—Ç–æ—Ä–∏—è –æ—á–∏—â–µ–Ω–∞</p>`;
  chat.appendChild(w);
});
</script>
</body>
</html>
